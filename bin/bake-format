#!/usr/bin/env ruby

$:.unshift(File.dirname(__FILE__)+"/../lib")

require_relative '../lib/format/bake_format'
require_relative '../lib/format/options/options'

$options = Bake::BakeFormatOptions.new(ARGV)
$options.parse_options()

data =
  if $options.input == '-'
    STDIN.read
  else
    File.read($options.input)
  end

out =
  if $options.output == '-'
    STDOUT
  elsif $options.output == '--'
    out = ($options.input == '-') ? STDOUT : File.open($options.input, 'w')
  else
    File.open($options.output, 'w')
  end

start_line = $options.start_line || 0
end_line = $options.end_line || data.lines.count

bake_format(data, out, $options.indent, start_line, end_line)
